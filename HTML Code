<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Multilingual Speech Translator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: #f0f0f5;
      min-height: 100vh;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    main {
      max-width: 720px;
      margin: 40px auto;
      background: #1a1a40;
      padding: 2.5rem 2rem;
      border-radius: 1rem;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.6);
    }
    label {
      color: #e0e0ff;
      font-weight: 600;
    }
    select.form-select, input.form-control {
      background-color: #2a2a60;
      border: 1px solid #5555aa;
      color: #e0e0ff;
      transition: border-color 0.3s ease;
    }
    select.form-select:hover, input.form-control:hover,
    select.form-select:focus, input.form-control:focus {
      border-color: #9c9cff;
      outline: none;
      box-shadow: 0 0 8px #9c9cff;
      background-color: #3a3a80;
      color: #e0e0ff;
    }
    button.btn-primary {
      background: linear-gradient(45deg, #ff6a00, #ee0979);
      border: none;
      font-weight: 700;
      letter-spacing: 0.05em;
      transition: background 0.4s ease;
    }
    button.btn-primary:hover {
      background: linear-gradient(45deg, #ee0979, #ff6a00);
      box-shadow: 0 0 12px #ff6a00cc;
    }
    /* Colored containers for the input groups */
    .mb-3 {
      background: linear-gradient(135deg, #3b3f72, #5c5f91);
      padding: 1rem 1.2rem;
      border-radius: 0.6rem;
      margin-bottom: 1.5rem;
      border: 1px solid #50547a;
      box-shadow: 0 0 10px rgba(124, 128, 182, 0.5);
      transition: box-shadow 0.3s ease;
    }
    .mb-3:hover {
      box-shadow: 0 0 16px rgba(124, 128, 182, 0.8);
    }
    #result {
      margin-top: 2rem;
      background: #2a2a60;
      padding: 1.8rem 2rem;
      border-radius: 0.8rem;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.7);
      color: #cddcff;
      font-size: 1.05rem;
      line-height: 1.5;
    }
    #result strong {
      color: #ffb347;
    }
    audio {
      margin-top: 1rem;
      width: 100%;
      border-radius: 0.4rem;
      box-shadow: 0 4px 14px rgba(255, 179, 71, 0.5);
      outline: none;
    }
    nav.navbar {
      background: #000000; /* changed to black */
      box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    }
    nav .navbar-brand {
      font-weight: 900;
      font-size: 1.6rem;
      letter-spacing: 0.1em;
      color: #d3d3d3 !important; /* changed to light gray */
      text-shadow: 0 0 10px #444444bb;
    }
  </style>
</head>
<body>

  <nav class="navbar navbar-expand-lg mb-4">
    <div class="container">
      <a class="navbar-brand" href="#">Multilingual Speech Translator</a>
    </div>
  </nav>

  <main class="container">
    <form id="translateForm">
      <div class="mb-3">
        <label for="targetLang" class="form-label">Select Target Language</label>
        <select id="targetLang" class="form-select" required>
          <option value="" disabled selected>Choose language</option>
          <option value="en">English</option>
          <option value="fr">French</option>
          <option value="es">Spanish</option>
          <option value="de">German</option>
          <option value="it">Italian</option>
          <option value="pt">Portuguese</option>
          <option value="nl">Dutch</option>
          <option value="ur">Urdu</option>
          <option value="ru">Russian</option>
          <option value="zh">Chinese</option>
          <option value="hi">Hindi</option>
          <option value="ar">Arabic</option>
          <option value="ja">Japanese</option>
          <option value="ko">Korean</option>
          <option value="tr">Turkish</option>
          <option value="sv">Swedish</option>
          <option value="fi">Finnish</option>
          <option value="el">Greek</option>
          <option value="id">Indonesian</option>
          <option value="vi">Vietnamese</option>
        </select>
      </div>

      <div class="mb-3">
        <label for="audioFile" class="form-label">Upload Audio File (WAV or MP3)</label>
        <input type="file" id="audioFile" accept=".wav,.mp3" class="form-control" required />
      </div>

      <button type="button" class="btn btn-primary" onclick="translateAudio()">Translate</button>
    </form>

    <section id="result" style="display:none;">
      <h2>Result</h2>
      <p><strong>Transcript:</strong> <span id="transcript"></span></p>
      <p><strong>Detected Language:</strong> <span id="detected_language"></span></p>
      <p><strong>English Translation:</strong> <span id="english_translation"></span></p>
      <p><strong>Translated Text:</strong> <span id="translated_text"></span></p>
      <audio id="audioPlayback" controls style="display:none;"></audio>
    </section>
  </main>

  <script>
    async function translateAudio() {
      const audioInput = document.getElementById('audioFile');
      const targetLang = document.getElementById('targetLang').value;
      const resultSection = document.getElementById('result');
      const transcriptSpan = document.getElementById('transcript');
      const detectedLangSpan = document.getElementById('detected_language');
      const englishTranslationSpan = document.getElementById('english_translation');
      const translatedTextSpan = document.getElementById('translated_text');
      const audioPlayback = document.getElementById('audioPlayback');

      if (audioInput.files.length === 0) {
        alert("Please select an audio file.");
        return;
      }
      if (!targetLang) {
        alert("Please select a target language.");
        return;
      }

      const formData = new FormData();
      formData.append('audio', audioInput.files[0]);
      formData.append('target_lang', targetLang);

      transcriptSpan.textContent = "";
      detectedLangSpan.textContent = "";
      englishTranslationSpan.textContent = "";
      translatedTextSpan.textContent = "";
      audioPlayback.style.display = 'none';
      audioPlayback.src = "";

      try {
        resultSection.style.display = 'block';
        resultSection.querySelector('h2').textContent = 'Translating...';

        const response = await fetch('/translate', {
          method: 'POST',
          body: formData
        });

        if (!response.ok) {
          throw new Error('Translation failed. Please try again.');
        }

        const data = await response.json();

        if (data.error) {
          throw new Error(data.error);
        }

        resultSection.querySelector('h2').textContent = 'Result';
        transcriptSpan.textContent = data.transcript || 'N/A';
        detectedLangSpan.textContent = data.detected_language || 'N/A';
        englishTranslationSpan.textContent = data.english_translation || 'N/A';
        translatedTextSpan.textContent = data.translated_text || 'N/A';

        if (data.audio_file_url) {
          audioPlayback.src = data.audio_file_url;
          audioPlayback.style.display = 'block';
          audioPlayback.play();
        } else {
          audioPlayback.style.display = 'none';
        }
      } catch (error) {
        resultSection.querySelector('h2').textContent = 'Error';
        transcriptSpan.textContent = '';
        detectedLangSpan.textContent = '';
        englishTranslationSpan.textContent = '';
        translatedTextSpan.textContent = error.message;
        audioPlayback.style.display = 'none';
      }
    }
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
